/* Universal box-sizing for consistent layout */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Basic body styling for full viewport height and flexible column layout */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f5f5;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Custom Scrollbar Styles for Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 10px; /* Vertical scrollbar width */
    height: 10px; /* Horizontal scrollbar height */
}

::-webkit-scrollbar-track {
    background: #f1f1f1; /* Light background for the track */
    border-radius: 5px;
}

::-webkit-scrollbar-thumb {
    background: #888; /* Darker thumb color */
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: #555; /* Even darker on hover */
}

/* Dark mode scrollbar styles */
body.dark-mode ::-webkit-scrollbar-track {
    background: #2d2d2d; /* Dark background for the track in dark mode */
}

body.dark-mode ::-webkit-scrollbar-thumb {
    background: #666; /* Lighter thumb color in dark mode */
}

body.dark-mode ::-webkit-scrollbar-thumb:hover {
    background: #999; /* Even lighter on hover in dark mode */
}

/* Toolbar styling for top section */
.toolbar {
    background: #ffffff;
    border-bottom: 1px solid #e0e0e0;
    padding: 8px 16px;
    display: flex;
    flex-wrap: wrap; /* Allow items to wrap to the next line on smaller screens */
    align-items: center;
    gap: 12px; /* Spacing between items */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Styling for select and text input fields within the toolbar */
.toolbar select, .toolbar input[type="text"] {
    padding: 6px 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
    flex-shrink: 0; /* Prevent shrinking on smaller screens */
}

/* Styling for standard buttons within the toolbar */
.toolbar button {
    padding: 6px 12px;
    border: 1px solid #0078d4;
    background: #0078d4;
    color: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    flex-shrink: 0;
}

.toolbar button:hover {
    background: #106ebe;
}

.toolbar button:disabled {
    background: #ccc;
    border-color: #ccc;
    cursor: not-allowed;
}

/* Style for checkbox buttons (e.g., Hide Folders) */
.toolbar-toggle-button {
    display: inline-flex; /* Use inline-flex to align with other buttons */
    align-items: center;
    gap: 5px;
    padding: 6px 12px;
    border: 1px solid #0078d4;
    background: #0078d4;
    color: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    flex-shrink: 0;
    transition: background 0.2s ease, border-color 0.2s ease;
}

.toolbar-toggle-button:hover {
    background: #106ebe;
    border-color: #106ebe;
}

.toolbar-toggle-button input[type="checkbox"] {
    margin: 0; /* Remove default margin */
    width: auto; /* Allow checkbox to take natural width */
    height: auto; /* Allow checkbox to take natural height */
    accent-color: #e0e0e0; /* Change checkbox color */
}

/* Dark mode for checkbox buttons */
body.dark-mode .toolbar-toggle-button {
    background: #0050a0; /* Darker blue for dark mode */
    border-color: #0050a0;
}

body.dark-mode .toolbar-toggle-button:hover {
    background: #0060c0;
    border-color: #0060c0;
}

body.dark-mode .toolbar-toggle-button input[type="checkbox"] {
    accent-color: #90caf9; /* Lighter checkbox color in dark mode */
}

/* Zoom controls layout */
.zoom-controls {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-left: auto; /* Pushes zoom controls to the right */
    flex-shrink: 0;
}

.zoom-slider {
    width: 100px;
}

/* Fixed width for zoom percentage display */
#zoomPercent {
    min-width: 45px; /* Adjust as needed to accommodate "500%" */
    text-align: center; /* Align text to the right within the fixed width */
    display: inline-block; /* Ensure min-width applies */
}

/* Breadcrumb/Path bar styling */
.breadcrumb {
    background: #ffffff;
    border-bottom: 1px solid #e0e0e0;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: #666;
    justify-content: space-between; /* Pushes content to ends */
    flex-wrap: wrap; /* Allow items to wrap */
}

.breadcrumb-path {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap; /* Allow path items to wrap */
}

.breadcrumb-item {
    cursor: pointer;
    color: #0078d4;
}

.breadcrumb-item:hover {
    text-decoration: underline;
}

.breadcrumb-separator {
    color: #666;
}

/* Styles for sort buttons in breadcrumb */
.breadcrumb-actions {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap; /* Allow action buttons to wrap */
    margin-left: auto; /* Pushes this group to the right */
}

.sort-buttons {
    display: flex;
    gap: 5px; /* Smaller gap between sort buttons */
    flex-wrap: wrap;
}

.sort-button {
    padding: 6px 10px; /* Slightly smaller padding than main toolbar buttons */
    border: 1px solid #0078d4;
    background: #e3f2fd; /* Lighter background for sort buttons */
    color: #0078d4;
    border-radius: 4px;
    cursor: pointer;
    font-size: 13px; /* Slightly smaller font */
    transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
}

.sort-button:hover {
    background: #cceeff;
    border-color: #0056b3;
}

.sort-button.sort-active {
    background: #0078d4;
    color: white;
    border-color: #0078d4;
    font-weight: bold;
}

/* Arrows for active sort buttons using pseudo-elements */
.sort-button.sort-active.sort-asc::after {
    content: ' ▲'; /* Up arrow for ascending */
    font-size: 0.8em;
}

.sort-button.sort-active.sort-desc::after {
    content: ' ▼'; /* Down arrow for descending */
    font-size: 0.8em;
}

/* Dark mode for breadcrumb and sort buttons */
body.dark-mode .breadcrumb {
    background: #1e1e1e;
    border-color: #333;
    color: #e0e0e0;
}

body.dark-mode .breadcrumb-item {
    color: #90caf9;
}

body.dark-mode .breadcrumb-separator {
    color: #aaa;
}

body.dark-mode .sort-button {
    background: #004080;
    color: #90caf9;
    border-color: #004080;
}

body.dark-mode .sort-button:hover {
    background: #0050a0;
    border-color: #0050a0;
}

body.dark-mode .sort-button.sort-active {
    background: #0078d4;
    color: white;
    border-color: #0078d4;
}

/* Icon styling for different file types */
.folder-icon {
    background: #ffd54f;
    color: #f57c00;
}

.file-icon.image {
    background: #81c784;
    color: #2e7d32;
}

.file-icon.document {
    background: #64b5f6;
    color: #1976d2;
}

.file-icon.default {
    background: #e0e0e0;
    color: #616161;
}

/* File name display below icons */
.file-name {
    font-size: 14px;
    text-align: center;
    word-break: break-word;
    max-width: 100%;
    line-height: 1.3;
    text-shadow: -1px -1px 0 #1e1e1e,
        1px -1px 0 #1e1e1e,
        -1px 1px 0 #1e1e1e,
        1px 1px 0 #1e1e1e;
}

/* Main content area layout (sidebar + file grid) */
.main-container {
    flex: 1; /* Takes remaining vertical space */
    display: flex;
    overflow: hidden; /* Prevents internal scrollbars from affecting main layout */
}

/* Sidebar for folder tree */
.sidebar {
    width: 300px;
    background: #fafafa;
    border-right: 1px solid #e0e0e0;
    overflow-y: auto; /* Enable scrolling for long folder lists */
    padding: 8px;
}

/* Styling for individual folder items in the tree */
.tree-item {
    padding: 4px 8px;
    cursor: pointer;
    border-radius: 4px;
    margin: 1px 0;
    display: flex;
    align-items: center;
    gap: 6px;
}

.tree-item:hover {
    background: #e3f2fd;
}

.tree-item.active {
    background: #0078d4;
    color: white;
}

/* Toggle icon for expanding/collapsing folders */
.tree-toggle {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    cursor: pointer;
}

/* Indentation for child folders */
.tree-children {
    margin-left: 20px;
}

/* Styling for hidden folders in config mode */
.tree-item.hidden-folder {
    color: #ff6b6b; /* Red text */
    text-decoration: line-through; /* Strikethrough */
}

/* Cursor change in directory config mode */
.dir-config-mode .tree-item {
    cursor: pointer;
}

.dir-config-mode .tree-item:hover {
    background-color: rgba(255, 107, 107, 0.1); /* Light red hover effect */
}

/* Content area for file grid */
.content-area {
    flex: 1; /* Takes remaining horizontal space */
    background: #ffffff;
    padding: 16px;
    /* Removed overflow-y: auto; -- now handled by .virtualized-scroll-container */
}

/* Virtualized Scroll Container */
.virtualized-scroll-container {
    flex: 1; /* Takes remaining vertical space within content-area */
    overflow-y: auto; /* This handles the main scrollbar */
    position: relative; /* For absolute positioning of the file-grid */
    height: 100%; /* Ensure it fills its parent */
    padding: 8px; /* Padding for the scrollable area */
}

/* File grid layout using CSS Grid */
.file-grid {
    display: grid;
    gap: 16px;
    /* Removed padding here, moved to .virtualized-scroll-container */
    --zoom-level: 1; /* Custom CSS property for zoom */
    grid-template-columns: repeat(auto-fill, minmax(calc(67px * var(--zoom-level)), 1fr));
    position: absolute; /* Positioned by JS within .virtualized-scroll-container */
    top: 0;
    left: 0;
    width: 100%;
    align-content: start; /* Align grid items to the start of the grid container */
    justify-content: start; /* Align grid items to the start of the grid container */
}

/* Styling for individual file items in the grid */
.file-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px;
    transition: all 0.2s ease;
    min-width: 0; /* Allows content to shrink */
    overflow: hidden;
    position: relative; /* Added for sash positioning */
    background-color: #f8f8f8; /* Default background for file items */
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

/* Placeholder for file items */
.file-item-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px;
    min-width: 0;
    overflow: hidden;
    position: relative;
    background-color: #e0e0e0; /* Light gray for placeholder */
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    animation: pulse 1.5s infinite ease-in-out; /* Skeleton loading animation */
}

.file-item-placeholder .file-icon-container {
    background-color: #ccc; /* Darker gray for icon area */
    border-radius: 4px;
}

.file-item-placeholder .file-name {
    background-color: #ccc; /* Darker gray for text area */
    height: 14px; /* Approximate line height */
    width: 80%; /* Simulate text width */
    margin-top: 8px;
    border-radius: 4px;
}

@keyframes pulse {
    0% {
        opacity: 0.6;
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 0.6;
    }
}


/* Container for file icons/thumbnails to maintain aspect ratio */
.file-icon-container {
    width: calc(64px * var(--zoom-level));
    height: calc(64px * var(--zoom-level));
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
    position: relative; /* Added for sash positioning */
    overflow: hidden; /* Ensure sash doesn't overflow */
}

/* Styling for the file icon itself */
.file-icon {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: calc(32px * var(--zoom-level));
    cursor: pointer; /* Added for consistent pointer cursor */
    user-select: none; /* Prevent text selection that causes I-beam cursor */
}

/* Styling for thumbnail images within icons */
.thumbnail-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

/* Hover and selection effects for file items */
.file-item:hover {
    background: #f0f8ff;
    border-color: #0078d4;
    transform: scale(1.05); /* Add slight zoom effect */
    z-index: 10; /* Ensure hovered item appears above others */
}

.file-item.selected {
    background: #e3f2fd;
    border: 2px solid #0078d4; /* Add a border to selected items */
    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.3); /* Blue glow for selected */
}

.thumbnail-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

/* Video thumbnail specific styles */
.video-thumbnail {
    position: relative;
    width: 100%;
    height: 100%;
}

.video-thumbnail video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

.video-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.7);
    color: white;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

/* File details panel on the right */
.file-details {
    position: fixed;
    right: 0;
    top: 0;
    bottom: 0;
    width: 300px;
    background: #ffffff;
    border-left: 1px solid #e0e0e0;
    padding: 16px;
    transform: translateX(100%); /* Start off-screen */
    transition: transform 0.3s ease; /* Smooth slide-in/out */
    overflow-y: auto;
    z-index: 2000; /* High z-index to appear on top */
}

.file-details.open {
    transform: translateX(0); /* Slide into view */
}

.details-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e0e0e0;
}

.close-details {
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
    color: #666;
}

/* Sections within file details (e.g., File Information, Tags) */
.metadata-section {
    margin-bottom: 20px;
}

.metadata-section h3 {
    font-size: 14px;
    margin-bottom: 8px;
    color: #333;
}

/* Individual fields within metadata sections */
.metadata-field {
    margin-bottom: 12px;
}

.metadata-field label {
    display: block;
    font-size: 12px;
    color: #666;
    margin-bottom: 4px;
}

.metadata-field input,
.metadata-field textarea,
.metadata-field select {
    width: 100%;
    padding: 6px 8px;
    border: 1px solid #ccc;
    border-radius: 4px; /* Consistent border radius */
    font-size: 12px;
}

/* Loading indicator styling */
.loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
    color: #666;
}

/* Status bar at the bottom */
.status-bar {
    background: #f8f9fa;
    border-top: 1px solid #e0e0e0;
    padding: 4px 16px;
    font-size: 12px;
    color: #666;
}

/* Utility class to hide elements */
.hidden {
    display: none !important;
}

/* Rating display styles */
.rating-group {
    margin-bottom: 5px;
}

.rating-group label {
    font-size: 13px;
    font-weight: bold;
    margin-bottom: 2px;
    display: block;
}

.rating {
    display: flex;
    gap: 1px;
}

.star {
    cursor: pointer;
    color: #ddd; /* Default star color (unfilled) */
    font-size: 36px;
    /* Added black outline */
    text-shadow: -1px -1px 0 #1e1e1e,
        1px -1px 0 #1e1e1e,
        -1px 1px 0 #1e1e1e,
        1px 1px 0 #1e1e1e;
}

.star.active {
    color: #ffc107; /* Active star color (filled) */
}

/* Dark mode specific styles */
body.dark-mode {
    background: #121212;
    color: #e0e0e0;
}

body.dark-mode .toolbar,
body.dark-mode .sidebar,
body.dark-mode .status-bar {
    background: #1e1e1e;
    border-color: #333;
}

body.dark-mode .content-area {
    background: #121212;
}

body.dark-mode .virtualized-scroll-container {
    background: #121212; /* Match content-area background */
}

body.dark-mode .file-item {
    background-color: #2d2d2d; /* Darker background for items */
    border-color: #444;
}

body.dark-mode .file-item-placeholder {
    background-color: #333; /* Darker placeholder */
}

body.dark-mode .file-item-placeholder .file-icon-container {
    background-color: #444; /* Even darker for icon area */
}

body.dark-mode .file-item-placeholder .file-name {
    background-color: #444; /* Even darker for text area */
}

body.dark-mode .file-item:hover {
    background: #3a3a3a;
}

body.dark-mode .tree-item:hover {
    background: #2d2d2d;
}

body.dark-mode .file-details {
    background: #1e1e1e;
    border-left-color: #333;
}

body.dark-mode .modal-content {
    background: #1e1e1e;
    color: #e0e0e0;
}

body.dark-mode input,
body.dark-mode select,
body.dark-mode textarea {
    background: #333;
    color: #fff;
    border-color: #555;
}

body.dark-mode .file-icon.default {
    background: #333;
    color: #aaa;
}

/* Styles for JSON display in metadata */
.json-display {
    background: #f8f8f8;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 4px;
    font-family: 'Courier New', Courier, monospace;
    font-size: 12px;
    white-space: pre-wrap; /* Preserve whitespace and wrap text */
    word-break: break-all; /* Break long words */
    max-height: 200px; /* Limit height */
    overflow-y: auto; /* Enable scrolling if content overflows */
}
body.dark-mode .json-display {
    background: #2d2d2d;
    border-color: #555;
    color: #e0e0e0;
}

/* Focus Window Styles (for image/video preview) */
.focus-overlay {
    position: fixed; /* Keep fixed to cover entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: none; /* Controlled by JS, starts hidden */
    justify-content: center; /* Center the main content */
    align-items: center; /* Center the main content */
    z-index: 1002; /* Increased z-index to be above modals and file details */
    cursor: default; /* Change cursor to default for the overlay */
    padding: 20px;
    right: 0; /* Default to 0, adjusted by JS if details panel is open */
}

.focus-overlay.with-gallery {
    display: flex;
    justify-content: center;
    align-items: center;
}

.focus-main-content {
    position: relative;
    padding: 0;
    z-index: 1;
    overflow: hidden; /* Ensure content doesn't spill out */
    display: flex; /* Still flex container */
    justify-content: center; /* Horizontal centering */
    align-items: center;
    width: 100%; /* Make it fill the available width from its parent */
    height: 100%; /* Make it fill the available height from its parent */
}

.focus-main-content img,
.focus-main-content video {
    max-width: 100%; /* Constrain to parent's width */
    max-height: 100%;
    width: auto; /* Allow natural width */
    height: auto; /* Allow natural height */
    object-fit: contain; /* Maintain aspect ratio and fit within bounds */
    border-radius: 4px;
    display: block; /* Important for transform-origin to work correctly */
    transform-origin: 0 0; /* Set transform origin to top-left for zoom-pan calculations */
    transform: translate(var(--pan-x, 0), var(--pan-y, 0)) scale(var(--zoom-factor, 1)); /* Apply zoom and pan */
    cursor: grab; /* Indicate draggable */
}

.focus-main-content img.dragging,
.focus-main-content video.dragging {
    cursor: grabbing;
}

.focus-main-content .no-preview-text {
    color: #fff;
    font-size: 1.2em;
    text-align: center;
}

.focus-file-name-display {
    position: absolute;
    bottom: 20px; /* Adjust as needed */
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px 15px;
    border-radius: 5px;
    font-size: 0.9em;
    z-index: 1001; /* Ensure it's above media but below controls */
    white-space: nowrap; /* Prevent text wrapping */
    overflow: hidden; /* Hide overflow if text is too long */
    text-overflow: ellipsis; /* Add ellipsis for long filenames */
    max-width: 80%; /* Limit width to prevent it from stretching too much */
}

body.dark-mode .focus-main-content .no-preview-text {
    color: #ccc;
}

/* Gallery Sidebar Styles */
.gallery-sidebar {
    position: absolute;
    top: 20px;
    left: 20px;
    height: calc(100% - 40px);
    background: #f0f0f0;
    border-radius: 8px;
    padding: 10px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    flex-shrink: 0;
    z-index: 2;

    /* Initial collapsed state */
    --gallery-thumb-size-min: 100px; /* User specified minimum thumbnail size */
    width: calc(var(--gallery-thumb-size-min) + 20px); /* 10px padding each side */
    transition: width 0.3s ease; /* Smooth transition for sidebar width */
}

body.dark-mode .gallery-sidebar {
    background: #2d2d2d;
}

.gallery-sidebar:hover {
    /* Expanded state, using a CSS variable set by JS for the active size */
    width: calc(var(--gallery-thumb-size-active) + 20px);
}

.gallery-controls {
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.gallery-image-thumbnail {
    object-fit: cover;
    border-radius: 4px;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease; /* Smooth transition for thumbnail size and border */

    /* Initial collapsed state */
    width: var(--gallery-thumb-size-min);
    height: var(--gallery-thumb-size-min);
}

.gallery-image-thumbnail:hover {
    border-color: #0078d4;
    transform: scale(1.02);
}

.gallery-image-thumbnail.active-gallery-image {
    border-color: #0078d4;
    box-shadow: 0 0 8px rgba(0, 120, 212, 0.5);
}

.gallery-sidebar:hover .gallery-image-thumbnail {
    /* Expanded state */
    width: var(--gallery-thumb-size-active);
    height: var(--gallery-thumb-size-active);
}

/* Sash for "Missing" files */
.missing-sash {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: calc(14px * var(--zoom-level));
    text-transform: uppercase;
    letter-spacing: 1px;
    pointer-events: none; /* Allow clicks to pass through */
    border-radius: 4px;
    z-index: 5;
}

/* Hidden Overlay Styles (for hidden files) */
.hidden-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex; /* Use flex to center the inner sash */
    justify-content: center;
    align-items: center;
    pointer-events: none; /* Allow clicks to pass through to the file item */
    border-radius: 4px;
    z-index: 6; /* Higher z-index than missing-sash */
    overflow: hidden; /* Important to clip the rotated sash */
}

.hidden-sash-line {
    position: absolute; /* Position relative to .hidden-overlay */
    width: 150%; /* Wider than 100% to ensure it covers diagonally */
    height: calc(20px * var(--zoom-level)); /* Thicker sash, scales with zoom */
    background-color: rgba(255, 0, 0, 0.25); /* Red with some transparency */
    color: rgba(255, 255, 255, 0.25); /* White with 25% transparency */
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: calc(12px * var(--zoom-level)); /* Adjust font size for the sash */
    text-transform: uppercase;
    letter-spacing: 1px;
    transform: rotate(-45deg); /* Rotate the sash */
    white-space: nowrap; /* Prevent text from wrapping */
    overflow: hidden; /* Hide text that goes beyond the sash */
    text-overflow: clip; /* Clip text instead of ellipsis */
}

/* Tag Pill Styles */
.tag-container {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    margin-top: 8px;
    margin-bottom: 10px;
}

.tag-pill {
    background-color: #e0e0e0;
    color: #333;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 4px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    white-space: nowrap;
}

.tag-pill:hover {
    background-color: #d0d0d0;
}

.tag-pill .remove-tag {
    font-weight: bold;
    cursor: pointer;
    color: #666;
    margin-left: 4px;
}

.tag-pill .remove-tag:hover {
    color: #c00;
}

/* Suggested Tags Box */
.suggested-tags-box {
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 8px;
    max-height: 100px;
    overflow-y: auto;
    margin-bottom: 10px;
    background-color: #f8f8f8;
    display: flex; /* Enable flexbox */
    flex-wrap: wrap; /* Allow items to wrap to the next line */
    gap: 5px; /* Spacing between tag pills */
}

.suggested-tags-box .tag-pill {
    cursor: pointer;
    background-color: #e6f7ff;
    color: #0078d4;
}

.suggested-tags-box .tag-pill:hover {
    background-color: #cceeff;
}

.suggested-tags-box .tag-pill .remove-tag {
    display: none; /* Hide remove button for suggested tags */
}

/* Dark mode for tags */
body.dark-mode .tag-pill {
    background-color: #333;
    color: #e0e0e0;
}

body.dark-mode .tag-pill:hover {
    background-color: #444;
}

body.dark-mode .tag-pill .remove-tag {
    color: #aaa;
}

body.dark-mode .suggested-tags-box {
    background-color: #2d2d2d;
    border-color: #555;
}

body.dark-mode .suggested-tags-box .tag-pill {
    background-color: #004080;
    color: #90caf9;
}

body.dark-mode .suggested-tags-box .tag-pill:hover {
    background-color: #0050a0;
}

/* Modal specific styles for settings and rating config */
.modal {
    position: fixed;
    z-index: 1001; /* Higher than focus overlay */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 600px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    position: relative;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 10px;
    margin-bottom: 15px;
}

.modal-header h2 {
    margin: 0;
    font-size: 18px;
}

.close-modal {
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    border: none;
    background: none;
}

.close-modal:hover,
.close-modal:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}

.modal-body {
    margin-bottom: 15px;
}

.modal-footer {
    border-top: 1px solid #e0e0e0;
    padding-top: 10px;
    text-align: right;
}

.modal-footer button {
    margin-left: 8px;
}

.setting-field {
    margin-bottom: 15px;
}

.setting-field label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.setting-field input[type="text"] {
    width: calc(100% - 70px); /* Adjust width to make space for button */
    display: inline-block;
    vertical-align: middle;
}

.setting-field button {
    display: inline-block;
    vertical-align: middle;
    margin-left: 5px;
}

/* Rating configuration specific sections */
.rating-config-section {
    margin-bottom: 20px;
    border: 1px solid #eee;
    padding: 15px;
    border-radius: 5px;
}

.rating-config-section h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 16px;
    color: #555;
}

.rating-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.rating-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px dashed #eee;
}

.rating-list-item:last-child {
    border-bottom: none;
}

.rating-list-item button {
    background: #dc3545;
    border: none;
    color: white;
    padding: 4px 8px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
}

.rating-list-item button:hover {
    background: #c82333;
}

.add-rating-input {
    display: flex;
    gap: 5px;
    margin-top: 10px;
}

.add-rating-input input {
    flex-grow: 1;
}

/* Category mapping checkboxes */
.category-mapping-item {
    margin-bottom: 10px;
    padding: 10px;
    border: 1px solid #f0f0f0;
    border-radius: 4px;
}

.category-mapping-item h5 {
    margin-top: 0;
    margin-bottom: 8px;
    font-size: 14px;
    color: #333;
}

.category-mapping-item .checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.category-mapping-item .checkbox-group label {
    display: flex;
    align-items: center;
    font-weight: normal;
    font-size: 12px;
    color: #333;
}

.category-mapping-item .checkbox-group input[type="checkbox"] {
    margin-right: 5px;
    width: auto;
}

/* Dark mode for modals and their contents */
body.dark-mode .modal-content {
    background-color: #1e1e1e;
    border-color: #333;
}

body.dark-mode .modal-header {
    border-color: #333;
}

body.dark-mode .close-modal {
    color: #e0e0e0;
}

body.dark-mode .close-modal:hover,
body.dark-mode .close-modal:focus {
    color: #fff;
}

body.dark-mode .rating-config-section {
    border-color: #333;
    background-color: #2d2d2d;
}

body.dark-mode .rating-config-section h4 {
    color: #ccc;
}

body.dark-mode .rating-list-item {
    border-bottom-color: #333;
}

body.dark-mode .category-mapping-item {
    border-color: #333;
    background-color: #2d2d2d;
}

body.dark-mode .category-mapping-item h5 {
    color: #e0e0e0;
}

body.dark-mode .category-mapping-item .checkbox-group label {
    color: #e0e0e0;
}

/* Error message for metadata */
.metadata-error {
    color: red;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Combined info overlay (rating and tags) on file icons */
.info-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: transparent; /* Background handled by file-icon-container */
    color: white;
    padding: calc(1px * var(--zoom-level));
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: center;
    overflow: hidden;
    text-align: center;
    line-height: 1.2;
    min-height: calc(18px * var(--zoom-level));
}

body.dark-mode .info-overlay {
    background-color: transparent;
    color: #e0e0e0;
}

/* Rating display within info overlay */
.rating-display {
    font-size: calc(10px * var(--zoom-level));
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #ffc107; /* Star color */
    padding-bottom: calc(0.1px * var(--zoom-level));
    position: absolute;
    bottom: calc(2px * var(--zoom-level));
    left: 0;
    right: 0;
    text-align: center;
}

/* Apply white outline to stars in the info overlay */
.rating-display .star-display {
    text-shadow: -1px -1px 0 #1e1e1e,
        1px -1px 0 #1e1e1e,
        -1px 1px 0 #1e1e1e,
        1px 1px 0 #1e1e1e;
}

/* Tags display within info overlay */
.tags-display {
    font-size: calc(2.5px * var(--zoom-level)); /* Ensure tag font scales */
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    line-height: 1;
    max-height: calc(14px * var(--zoom-level));
    overflow: hidden;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    text-align: center;
}

.tags-display .tag-pill {
    padding: calc(0.1px * var(--zoom-level)) calc(2px * var(--zoom-level));
    margin: calc(0.1px * var(--zoom-level));
    font-size: inherit;
    border-radius: calc(2px * var(--zoom-level));
    background-color: transparent;
    color: white; /* Tags text color */
    border: 1px solid rgba(255, 255, 255, 0.3); /* Transparent white border */
}

body.dark-mode .tags-display .tag-pill {
    color: #e0e0e0;
    border-color: rgba(0, 0, 0, 0.3);
}

/* Filter Modal specific styles */
.filter-modal-body {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.filter-section {
    border: 1px solid #eee;
    padding: 15px;
    border-radius: 5px;
}

.filter-section h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 16px;
    color: #555;
}

.filter-section input[type="text"] {
    width: 100%;
    padding: 6px 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
}

.filter-suggested-tags-container {
    max-height: 120px;
    overflow-y: auto;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 8px;
    margin-top: 10px;
    background-color: #f8f8f8;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

.filter-suggested-tags-container .tag-pill {
    background-color: #e6f7ff;
    color: #0078d4;
    cursor: pointer;
}

.filter-suggested-tags-container .tag-pill:hover {
    background-color: #cceeff;
}

.filter-suggested-tags-container .tag-pill .tag-count {
    font-size: 0.8em;
    margin-left: 5px;
    color: #666;
}

.active-filter-tags-container {
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 8px;
    min-height: 40px;
    background-color: #f8f8f8;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

.active-filter-tags-container .tag-pill {
    background-color: #0078d4;
    color: white;
}

.active-filter-tags-container .tag-pill .remove-tag {
    color: white;
}

/* Dark mode for filter modal */
body.dark-mode .filter-section h4 {
    color: #ccc;
}
body.dark-mode .filter-suggested-tags-container,
body.dark-mode .active-filter-tags-container {
    background-color: #2d2d2d;
    border-color: #555;
}
body.dark-mode .filter-suggested-tags-container .tag-pill {
    background-color: #004080;
    color: #90caf9;
}
body.dark-mode .filter-suggested-tags-container .tag-pill:hover {
    background-color: #0050a0;
}
body.dark-mode .filter-suggested-tags-container .tag-pill .tag-count {
    color: #aaa;
}
body.dark-mode .active-filter-tags-container .tag-pill {
    background-color: #0050a0;
}
body.dark-mode .active-filter-tags-container .tag-pill .remove-tag {
    color: #fff;
}
/* --- ComfyUI Workflow Metadata Styles (Refined for Narrow Pane) --- */

/* Base styling for the entire metadata section within the file details pane */
/* Assuming the direct parent of .metadata-section in the file details pane is .file-details or similar */
.file-details .metadata-section {
    padding: 0; /* Remove padding here, let inner elements define their spacing */
    margin-bottom: 20px; /* Space below the entire section */
    background: transparent; /* Inherit from parent */
    border-radius: 0;
    box-shadow: none;
}

/* Header for the metadata section (e.g., "ComfyUI Workflow Metadata") */
.file-details .metadata-section > h3 { /* Target direct h3 child to avoid conflicts */
    font-size: 16px;
    color: #333;
    border-bottom: 1px solid #e0e0e0;
    padding-bottom: 8px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Copy All button within the metadata section header */
.file-details .metadata-section .copy-button {
    padding: 6px 12px;
    font-size: 13px;
    background: #0078d4;
    border-color: #0078d4;
    /* Add any other base button styles you have globally if they are not picked up */
}

.file-details .metadata-section .copy-button:hover {
    background: #106ebe;
    border-color: #106ebe;
}


/* Wrapper for each individual category (e.g., "Positive Prompts") */
.file-details .metadata-section .metadata-category {
    margin-bottom: 15px; /* Spacing between categories */
    padding: 10px; /* Padding inside each category box */
    background-color: #fcfcfc; /* A subtle background to group items */
    border: 1px solid #e0e0e0; /* Light border */
    border-radius: 4px; /* Consistent with other elements */
}

/* Category titles (e.g., "Positive Prompts:") */
.file-details .metadata-section .metadata-category h4 {
    color: #333;
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 14px;
    border-bottom: 1px dashed #eee; /* Subtle dashed separator */
    padding-bottom: 5px;
}

/* Description list for key-value pairs */
.file-details .metadata-section .metadata-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

/* Wrapper for each metadata key-value item - STACKED FOR NARROW PANE */
.file-details .metadata-section .metadata-item {
    display: flex;
    flex-direction: column; /* Stack title above value */
    align-items: flex-start; /* Align contents to the left */
    margin-bottom: 8px; /* Spacing between items */
    padding-bottom: 8px;
    border-bottom: 1px dotted #f0f0f0; /* Very subtle separator */
}

.file-details .metadata-section .metadata-item:last-child {
    border-bottom: none; /* No border for the last item in a category */
}

/* Styling for the metadata key (e.g., "Prompt 1", "VAE Model") */
.file-details .metadata-section .metadata-title {
    font-weight: bold;
    color: #555;
    width: 100%; /* Take full width */
    text-align: left; /* Align titles to the left */
    padding-right: 0;
    margin-bottom: 5px; /* Add space below title */
    word-wrap: break-word; /* Ensure long titles wrap */
    font-size: 13px;
}

/* Styling for the metadata value content */
.file-details .metadata-section .metadata-value {
    flex-grow: 1; /* Allow value to take up remaining space */
    color: #222;
    background-color: #fdfdfd; /* A very light background for the value box */
    border: 1px solid #e9e9e9;
    border-radius: 4px;
    padding: 8px 12px;
    position: relative; /* Crucial for absolute positioning of the copy button */
    word-break: break-word; /* Ensure long values wrap */
    font-size: 13px;
    line-height: 1.4;
    width: 100%; /* Ensure it takes full width when stacked */
}

/* Inner content div to allow for max-height and scrolling */
.file-details .metadata-section .metadata-field-content {
    max-height: 100px; /* Limit height for long prompts, similar to .json-display */
    overflow-y: auto; /* Add scrollbar if content exceeds max-height */
    padding-right: 25px; /* Make space for the inline copy button */
}

/* Specific styling for JSON content within metadata values */
.file-details .metadata-section .metadata-field-content.metadata-json {
    font-family: 'Courier New', monospace; /* Consistent with .json-display */
    background-color: #f8f8f8; /* Consistent with .json-display */
    border: 1px solid #ddd; /* Consistent with .json-display */
    padding: 8px;
    border-radius: 4px;
    font-size: 12px; /* Smaller font for JSON readability */
    white-space: pre-wrap; /* Preserve whitespace and wrap text */
    word-break: break-all; /* Break long words */
}


/* Inline copy button (SVG icon) */
.file-details .metadata-section .copy-button-inline {
    position: absolute;
    top: 5px; /* Position from the top right of .metadata-value */
    right: 5px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 3px;
    opacity: 0.7;
    transition: opacity 0.2s ease, transform 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.file-details .metadata-section .copy-button-inline:hover {
    opacity: 1;
    transform: scale(1.1);
}

.file-details .metadata-section .copy-button-inline svg {
    fill: #666;
    width: 14px;
    height: 14px;
}

/* Specific styling for the "other categories" group if you want it visually distinct */
.file-details .metadata-section .metadata-category-group {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid #e0e0e0; /* A line to separate prominent from other categories */
}

/* Adjustments for categories within the 'other group' to make them less prominent */
.file-details .metadata-section .metadata-category-group .metadata-category {
    background-color: transparent; /* No background */
    border: none; /* No border */
    padding: 0; /* Remove padding */
    margin-bottom: 10px; /* Slightly less margin */
}

.file-details .metadata-section .metadata-category-group .metadata-category h4 {
    font-size: 13px; /* Smaller font for category titles */
    color: #666; /* Subtler color */
    border-bottom: none; /* No border for sub-category titles */
    margin-bottom: 5px;
}

.file-details .metadata-section .metadata-category-group .metadata-item {
    font-size: 0.9em; /* Slightly smaller text */
    padding-bottom: 5px;
    margin-bottom: 5px;
}

.file-details .metadata-section .metadata-category-group .metadata-title {
    font-weight: normal; /* Less emphasis on title */
    color: #777; /* Subtler color */
    /* Remove width constraint, let it naturally flow */
}

.file-details .metadata-section .metadata-category-group .metadata-value {
    background-color: #f5f5f5; /* Lighter background for these values */
    border-color: #eee;
    padding: 5px 10px;
    font-size: 0.9em;
}


/* --- Dark Mode Overrides for Workflow Metadata --- */

body.dark-mode .file-details .metadata-section > h3 {
    color: #e0e0e0;
    border-bottom-color: #333;
}

body.dark-mode .file-details .metadata-section .metadata-category {
    background-color: #2d2d2d;
    border-color: #333;
}

body.dark-mode .file-details .metadata-section .metadata-category h4 {
    color: #e0e0e0;
    border-bottom-color: #333;
}

body.dark-mode .file-details .metadata-section .metadata-item {
    border-bottom-color: #333;
}

body.dark-mode .file-details .metadata-section .metadata-title {
    color: #aaa;
}

body.dark-mode .file-details .metadata-section .metadata-value {
    background-color: #1e1e1e;
    border-color: #333;
    color: #e0e0e0;
}

body.dark-mode .file-details .metadata-section .metadata-field-content.metadata-json {
    background-color: #1a1a1a;
    border-color: #444;
    color: #f0f0f0;
}

body.dark-mode .file-details .metadata-section .copy-button-inline svg {
    fill: #aaa;
}

body.dark-mode .file-details .metadata-section .metadata-category-group {
    border-top-color: #333;
}

body.dark-mode .file-details .metadata-section .metadata-category-group .metadata-category h4 {
    color: #999;
}

body.dark-mode .file-details .metadata-section .metadata-category-group .metadata-title {
    color: #bbb;
}

body.dark-mode .file-details .metadata-section .metadata-category-group .metadata-value {
    background-color: #222;
    border-color: #444;
}

/* CSS from index.html (ensure these are integrated or removed if redundant) */
body {
    font-family: 'Inter', sans-serif;
    background-color: #f4f4f4;
    color: #333;
    display: flex;
    height: 100vh;
    overflow: hidden; /* Prevent scroll on body */
}

.dark-mode {
    background-color: #1a202c;
    color: #e2e8f0;
}

.dark-mode .bg-white {
    background-color: #2d3748;
}

.dark-mode .bg-gray-100 {
    background-color: #4a5568;
}

.dark-mode .text-gray-700 {
    color: #e2e8f0;
}

.dark-mode .border-gray-300 {
    border-color: #4a5568;
}

.dark-mode input, .dark-mode select, .dark-mode textarea {
    background-color: #2d3748;
    border-color: #4a5568;
    color: #e2e8f0;
}

.dark-mode .hover\:bg-gray-200:hover {
    background-color: #616e7f;
}

/* These .file-item styles from index.html's embedded style block are largely redundant or conflicting with style.css.
   I will prioritize the ones in style.css and remove these if they are duplicates.
   The user explicitly asked to respect the original code theme, so I will merge them carefully.
   The `file-item` styles from `style.css` are more comprehensive.
   I'll keep the `selected` and `hover` states from this block if they add distinct visual cues.
*/
/*
.dark-mode .file-item {
    background-color: #2d3748;
    border-color: #4a5568;
}

.dark-mode .file-item.selected {
    background-color: #4a5568;
    border-color: #63b3ed;
}

.dark-mode .file-item:hover {
    background-color: #4a5568;
}
*/

.dark-mode .modal-content {
    background-color: #2d3748;
    color: #e2e8f0;
}

.dark-mode .modal-header {
    border-bottom-color: #4a5568;
}

.dark-mode .modal-footer {
    border-top-color: #4a5568;
}

/* Context Menu Styles - ADDED/UPDATED */
.context-menu {
    position: fixed; /* Use fixed positioning relative to the viewport */
    background-color: #fff; /* Default light mode background */
    border: 1px solid #ccc;
    border-radius: 0.25rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    padding: 0.5rem 0; /* Padding for menu items */
    z-index: 2000; /* High z-index to ensure it's on top of other elements */
    min-width: 150px; /* Ensure it has a minimum width */
    display: block; /* Ensure it's displayed as a block element when not hidden */
}

.context-menu-item {
    padding: 0.5rem 1rem;
    cursor: pointer;
    white-space: nowrap; /* Prevent text wrapping */
    color: #333; /* Default text color */
}

.context-menu-item:hover {
    background-color: #f0f0f0;
}

/* Dark mode overrides for context menu */
body.dark-mode .context-menu {
    background-color: #2d3748;
    border-color: #4a5568;
}

body.dark-mode .context-menu-item {
    color: #e2e8f0; /* Explicitly set text color for dark mode */
}

body.dark-mode .context-menu-item:hover {
    background-color: #4a5568;
}


/* Layout - These are mostly redundant with the main style.css. I will remove them and rely on the main style.css. */
/*
.folder-tree {
    width: 25%;
    min-width: 200px;
    max-width: 400px;
    overflow-y: auto;
    flex-shrink: 0;
    border-right: 1px solid #e2e8f0;
}

.file-grid-container {
    flex-grow: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.file-grid {
    display: grid;
    gap: 1rem;
    padding: 1rem;
    flex-grow: 1;
    align-content: start;
}
*/

/* File Item specific styles - I will merge these with the .file-item and its children in style.css */
/*
.file-item {
    border-radius: 0.5rem;
    overflow: hidden;
    transition: all 0.2s ease-in-out;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100%;
    cursor: pointer;
    position: relative;
}

.file-item.selected {
    border: 2px solid #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
}

.file-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.file-item-thumbnail {
    width: 100%;
    height: 120px;
    object-fit: contain;
    background-color: #e2e8f0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: #a0aec0;
}

.file-item-info {
    padding: 0.5rem;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.file-item-name {
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
}

.file-item-tags {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 0.25rem;
    min-height: 1.25rem;
}

.file-item-tag {
    background-color: #e0e7ff;
    color: #4338ca;
    font-size: 0.625rem;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    margin: 0.125rem;
    white-space: nowrap;
}

.dark-mode .file-item-tag {
    background-color: #4338ca;
    color: #e0e7ff;
}

.file-item-rating {
    font-size: 0.75rem;
    font-weight: 600;
    margin-top: 0.25rem;
    color: #4f46e5;
}

.dark-mode .file-item-rating {
    color: #a78bfa;
}
*/

/* Folder Tree Specifics - These are mostly redundant with the main style.css. I will remove them and rely on the main style.css. */
/*
.folder-tree {
    padding: 0.5rem;
}

.folder-item {
    padding: 0.5rem 0.75rem;
    cursor: pointer;
    transition: background-color 0.1s ease;
    display: flex;
    align-items: center;
}

.folder-item:hover {
    background-color: #e2e8f0;
}

.dark-mode .folder-item:hover {
    background-color: #4a5568;
}

.folder-item.active {
    background-color: #d1e0fc;
    font-weight: 600;
}

.dark-mode .folder-item.active {
    background-color: #3a475a;
}

.folder-item-icon {
    margin-right: 0.5rem;
    color: #a0aec0;
}

.folder-item-name {
    flex-grow: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.folder-toggle-icon {
    margin-left: auto;
    transition: transform 0.2s ease;
}

.folder-toggle-icon.rotated {
    transform: rotate(90deg);
}

.folder-children {
    margin-left: 1rem;
    border-left: 1px dashed #cbd5e0;
}

.dark-mode .folder-children {
    border-left: 1px dashed #616e7f;
}
*/

/* File Details Panel - These are mostly redundant with the main style.css. I will remove them and rely on the main style.css. */
/*
.file-details-panel {
    width: 0;
    overflow-x: hidden;
    transition: width 0.3s ease-in-out;
    flex-shrink: 0;
    border-left: 1px solid #e2e8f0;
    background-color: #ffffff;
    position: relative;
    display: flex;
    flex-direction: column;
}

.file-details-panel.open {
    width: 400px;
}

.dark-mode .file-details-panel {
    background-color: #2d3748;
    border-left-color: #4a5568;
}

.details-header {
    padding: 1rem;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.dark-mode .details-header {
    border-bottom-color: #4a5568;
}

.details-content-area {
    flex-grow: 1;
    overflow-y: auto;
    padding: 1rem;
}

.details-field {
    margin-bottom: 1rem;
}

.details-label {
    font-weight: 600;
    margin-bottom: 0.25rem;
    display: block;
}

.details-value {
    background-color: #f0f4f8;
    padding: 0.5rem;
    border-radius: 0.25rem;
    word-break: break-all;
    white-space: pre-wrap;
}

.dark-mode .details-value {
    background-color: #4a5568;
}

.details-input {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.25rem;
    background-color: #ffffff;
    color: #333;
}

.dark-mode .details-input {
    background-color: #2d3748;
    border-color: #4a5568;
    color: #e2e8f0;
}

.tag-input-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.25rem;
    padding: 0.5rem;
    background-color: #ffffff;
}

.dark-mode .tag-input-container {
    border-color: #4a5568;
    background-color: #2d3748;
}

.tag-display {
    background-color: #e0e7ff;
    color: #4338ca;
    font-size: 0.625rem;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    margin: 0.125rem;
    white-space: nowrap;
}

.dark-mode .tag-display {
    background-color: #4338ca;
    color: #e0e7ff;
}

.tag-remove-btn {
    background: none;
    border: none;
    color: #4338ca;
    cursor: pointer;
    font-size: 0.75rem;
    padding: 0;
}

.dark-mode .tag-remove-btn {
    color: #e0e7ff;
}

.tag-input {
    flex-grow: 1;
    border: none;
    outline: none;
    background: transparent;
    min-width: 80px;
}

.rating-input-group {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.rating-input-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.rating-input {
    width: 60px;
    padding: 0.25rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.25rem;
    text-align: center;
    background-color: #ffffff;
    color: #333;
}

.dark-mode .rating-input {
    background-color: #2d3748;
    border-color: #4a5568;
    color: #e2e8f0;
}
*/

/* Initial Setup Overlay and Modal */
.initial-setup-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6); /* Slightly darker for better blur effect */
    backdrop-filter: blur(8px); /* Apply blur to content behind */
    z-index: 1000; /* Ensures it's on top of all other content */
    display: flex;
    justify-content: center;
    align-items: center;
}

.initial-setup-modal {
    background-color: var(--background-color-darker); /* Or a specific light background for contrast */
    color: var(--text-color);
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    z-index: 1001; /* Above the overlay */
    text-align: center;
    max-width: 550px;
    width: 90%;
    border: 1px solid var(--border-color); /* Optional: add a subtle border */
}

.initial-setup-modal h2 {
    margin-top: 0;
    color: var(--accent-color);
    font-size: 1.8em;
    margin-bottom: 15px;
}

.initial-setup-modal p {
    margin-bottom: 20px;
    font-size: 1.1em;
}

.initial-setup-modal .input-group {
    margin-bottom: 15px;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 10px; /* Space between label, input, and button */
}

.initial-setup-modal label {
    flex-shrink: 0; /* Prevent label from shrinking */
    width: 150px; /* Fixed width for labels for alignment */
    font-weight: bold;
}

.initial-setup-modal input[type="text"] {
    flex-grow: 1; /* Input takes up remaining space */
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    background-color: var(--input-background-color);
    color: var(--text-color);
    font-size: 1em;
}

.initial-setup-modal .browse-btn {
    padding: 10px 15px;
    background-color: var(--button-background);
    color: var(--button-text-color);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.95em;
    transition: background-color 0.2s ease-in-out;
}

.initial-setup-modal .browse-btn:hover {
    background-color: var(--button-hover-background);
}

.initial-setup-modal button#saveInitialPathsBtn {
    padding: 15px 30px;
    background-color: var(--primary-button-background); /* A distinct primary color */
    color: var(--primary-button-text-color);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: bold;
    margin-top: 25px;
    transition: background-color 0.2s ease-in-out;
}

.initial-setup-modal button#saveInitialPathsBtn:hover {
    background-color: var(--primary-button-hover-background);
}

.initial-setup-modal .error-message {
    color: var(--error-color, #ff4c4c); /* Red for error messages */
    margin-top: 15px;
    font-size: 0.95em;
}

/* Helper class to hide elements */
.hidden {
    display: none !important;
}

/* Generic modal overlay style */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7); /* Dark semi-transparent background */
    z-index: 99; /* Below the modal content but above other page content */
    display: none; /* Hidden by default, controlled by JS */
}

/* Generic modal container style */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex; /* Use flexbox for centering */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    z-index: 100; /* Above the overlay */
    pointer-events: none; /* Allow clicks to pass through when hidden */
}

.modal.hidden {
    display: none; /* Ensure it's truly hidden when the class is applied */
}

/* Modal content styling */
.modal-content {
    background-color: var(--background-color-darker);
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    width: 90%;
    max-width: 500px; /* Adjust max-width as needed */
    color: var(--text-color);
    position: relative; /* For positioning close button if needed */
    pointer-events: auto; /* Allow clicks on the content itself */
    transform: translateY(-50px); /* Initial slight offset for animation */
    opacity: 0; /* Start invisible for animation */
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}

/* When the modal is active (not hidden), apply final styles */
.modal:not(.hidden) .modal-content {
    transform: translateY(0);
    opacity: 1;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.modal-header h2 {
    margin: 0;
    color: var(--accent-color);
}

.modal-body p {
    margin-bottom: 15px;
    line-height: 1.5;
}

.setting-field {
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.setting-field label {
    flex-shrink: 0;
    font-weight: bold;
}

.setting-field input[type="text"] {
    flex-grow: 1;
    padding: 8px 12px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background-color: var(--input-background-color);
    color: var(--text-color);
}

.setting-field button {
    padding: 8px 15px;
    background-color: var(--button-background);
    color: var(--button-text-color);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.setting-field button:hover {
    background-color: var(--button-hover-background);
}

.error-message {
    color: #ff4d4d; /* Red color for error messages */
    margin-top: 10px;
    text-align: center;
    font-weight: bold;
}

.modal-footer {
    margin-top: 20px;
    text-align: right;
}

.modal-footer button {
    padding: 10px 20px;
    background-color: var(--primary-button-background);
    color: var(--primary-button-text-color);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.2s ease;
}

.modal-footer button:hover {
    background-color: var(--primary-button-hover-background);
}

/* Basic Dark Mode Variables (ensure these are defined in your main CSS) */
body.dark-mode {
    --background-color: #222;
    --background-color-darker: #1a1a1a;
    --text-color: #eee;
    --text-color-light: #bbb;
    --accent-color: #4CAF50;
    --border-color: #444;
    --input-background-color: #333;
    --primary-button-background: #4CAF50;
    --primary-button-hover-background: #45a049;
    --primary-button-text-color: white;
    --button-background: #555;
    --button-hover-background: #666;
    --button-text-color: white;
}

/* Basic Light Mode Variables (ensure these are defined in your main CSS) */
body:not(.dark-mode) {
    --background-color: #f4f4f4;
    --background-color-darker: #e0e0e0;
    --text-color: #333;
    --text-color-light: #555;
    --accent-color: #007bff;
    --border-color: #ccc;
    --input-background-color: #fff;
    --primary-button-background: #007bff;
    --primary-button-hover-background: #0056b3;
    --primary-button-text-color: white;
    --button-background: #e9e9e9;
    --button-hover-background: #d4d4d4;
    --button-text-color: #333;
}

/* Ensure .hidden class is defined */
.hidden {
    display: none !important;
}

